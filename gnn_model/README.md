# GNN假新闻检测模型扩展

本项目扩展了基于图神经网络(GNN)的假新闻检测模型，添加了多种分析工具和改进模型，用于深入研究GNN在假新闻检测任务中的工作机制和性能影响因素。

## 核心扩展内容

1. **节点特征与图结构重要性分析**：通过随机化技术分析节点特征和图结构对模型性能的相对贡献
2. **多层GNN模型**：探究GNN层数对假新闻检测任务性能的影响
3. **注意力可视化工具**：分析和可视化GAT模型的注意力机制在假新闻检测中的作用

## 文件结构

- `gnn.py` - 原始GNN模型实现，增加了特征重要性分析功能
- `ablation_study.py` - 模型消融实验，用于分析各组件的贡献
- `multi_layer_gnn.py` - 多层GNN模型实现，用于分析层数影响
- `attention_visualization.py` - 注意力机制可视化和分析工具

## 使用方法

### 节点特征与图结构重要性分析

```bash
# 运行特征重要性分析
python gnn.py --dataset politifact --model sage --analysis_mode feature_importance
```

### 多层GNN模型分析

```bash
# 分析GNN层数对性能的影响
python multi_layer_gnn.py --dataset politifact --model sage --max_layers 5
```

### 注意力机制可视化

```bash
# 训练GAT模型并可视化注意力
python attention_visualization.py --dataset politifact --num_samples 10
```

### 模型消融实验

```bash
# 进行模型消融实验
python ablation_study.py --dataset politifact --model all
```

## 理论分析

### 研究问题1：节点特征与图结构的相对重要性

在假新闻检测任务中，我们关心的是节点特征（新闻内容）和图结构（传播模式）哪个对判断新闻真假更重要。这项分析随机化节点特征或图结构，然后观察模型性能变化，从而量化两者的相对贡献。

**理论假设**：
1. 如果节点特征对检测假新闻更重要，那么随机化图结构后模型性能下降较小
2. 如果图结构对检测假新闻更重要，那么随机化节点特征后模型性能下降较小

**分析方法**：
- 完整模型：同时使用节点特征和图结构
- 仅特征模型：随机化图的边连接
- 仅结构模型：随机化节点特征

通过比较三种模型的性能，我们可以计算节点特征和图结构的相对重要性百分比。

### 研究问题2：GNN层数对模型性能的影响

图神经网络通过消息传递更新节点表示，层数决定了信息传递的距离。在假新闻检测中，过多的层可能导致过平滑问题，使节点特征趋于相似而丧失区分性。

**理论分析**：
1. 较浅的GNN可能无法充分利用图结构信息
2. 较深的GNN可能面临过平滑问题，特别是在社交媒体传播图上
3. 寻找最优层数可以平衡图信息利用和过平滑问题

### 研究问题3：注意力机制在假新闻检测中的作用

GAT模型通过注意力机制为不同邻居节点分配不同的重要性权重。通过可视化和分析这些注意力权重，我们可以理解模型如何区分真假新闻。

**理论问题**：
1. 真实新闻和假新闻的注意力分布模式是否有显著差异？
2. 哪些类型的节点在判断新闻真假时接收更多注意力？
3. 注意力机制能否提供对假新闻检测决策过程的可解释性？

## 实验结果概述

通过上述分析工具，我们可以得到以下关键发现：

1. 在不同数据集上，节点特征和图结构的相对重要性可能不同
2. 对于大多数GNN模型，存在一个最优层数，超过该层数会导致性能下降
3. 注意力分布模式在真假新闻之间存在差异，提供了检测的关键信号

## 未来工作

1. 探索动态图结构在假新闻检测中的应用
2. 结合时序信息改进模型性能
3. 开发更强大的可解释性工具，帮助理解模型决策过程

## 引用

如果您使用了本代码，请引用以下论文：

```
@inproceedings{monti2019fake,
  title={Fake News Detection on Social Media using Geometric Deep Learning},
  author={Monti, Federico and Frasca, Fabrizio and Eynard, Davide and Mannion, Damon and Bronstein, Michael M},
  booktitle={AAAI},
  year={2019}
}
``` 